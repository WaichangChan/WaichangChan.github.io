webpackJsonp([0],{79:function(r,e,t){"use strict";function n(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function a(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?r:e}function o(r,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=t(0),f=t.n(i),u=t(80),c=t(84),s=(t.n(c),function(){function r(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}()),l=function(r){function e(){var r,t,o,i;n(this,e);for(var f=arguments.length,c=Array(f),s=0;s<f;s++)c[s]=arguments[s];return t=o=a(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(c))),o.canvasRef=null,o.handleRef=function(r){r?(o.canvasRef=r,Object(u.b)(o.canvasRef.getContext("2d"))):Object(u.c)()},i=t,a(o,i)}return o(e,r),s(e,[{key:"render",value:function(){return f.a.createElement("section",{className:"topic-body"},f.a.createElement("h4",{className:"topic-title"},"\u4fc4\u7f57\u65af\u65b9\u5757"),f.a.createElement("canvas",{className:"tetris",width:200,height:320,ref:this.handleRef}))}}]),e}(i.Component);e.default=l},80:function(r,e,t){"use strict";function n(){j.clearRect(0,0,k*w,g*w);for(var r=0;r<g;r++)for(var e=0;e<k;e++)a(r,e)}function a(r,e){switch(A[r][e]){case 0:break;case 2:o(j,e*w,r*w,w,"#0f0");break;case 1:o(j,e*w,r*w,w)}}function o(r,e,t,n,a){r.fillStyle=a||"#f00",r.fillRect(e,t,n,n),r.strokeRect(e,t,n,n)}function i(r,e){var t=r.x-1,n=t+3,a=r.y-1,o=a+3;if(!(t<0||n-1===k)){void 0===e&&(e=90);var i=null,f=u(r);if(!0!==f){switch(f){case"right":if(1===A[o][r.x]?c(r,2):c(r)){var l=u(r);if(l instanceof Array){t=r.x-1,n=t+3,a=r.y-1,o=a+3,i=l;break}1===A[o][r.x]?s(r,2):s(r)}return;case"left":if(s(r)){var v=u(r);if(v instanceof Array){t=r.x-1,n=t+3,a=r.y-1,o=a+3,i=v;break}c(r)}return;case"top":case"bottom":return;default:i=f}var y=A[r.y][n],h=A[o][r.x];1!==y||90!==e&&270!==e?1!==h||90!==e&&270!==e||(A[r.y][n]=1,A[o][r.x]=0):(A[r.y][n]=0,A[o][r.x]=1);for(var b=a,p=0;b<o;b++,p++)for(var x=t,d=0;x<n;x++,d++)2!==A[b][x]&&(A[b][x]=i[p][d])}}}function f(r){for(var e=r.y+3;e>=r.y;e--)for(var t=r.x-1,n=t+4;t<n;t++)if(!A[e]||2===(A[e][t]&&A[e][t])){var a=e-1;if(A[a]&&1===A[a][t])return!1}for(var o=r.y+3;o>=r.y;o--)for(var i=r.x-1,f=i+4;i<f;i++){var u=o-1;if(A[u]&&A[u][i]){var c=A[u][i];1===c&&(A[o][i]=c,A[o-1][i]=0)}}return r.y++,!0}function u(r){var e={x:r.x,y:r.y-1,value:A[r.y-1][r.x]};if(1===e.value&&2===A[e.y][r.x-1])return"left";var t={x:r.x-1,y:r.y,value:A[r.y][r.x-1]};if(1===t.value&&2===A[r.y+1][t.x])return"left";var n={x:r.x+1,y:r.y,value:A[r.y][r.x+1]};if(1===n.value&&2===A[r.y-1][n.x])return"right";if(1==={x:r.x,y:r.y+1,value:A[r.y+1][r.x]}.value&&2===A[r.y][r.x+1])return"right";var a=r.x+2,o=r.y+2,i=A[r.y][a],f=A[o]&&A[o][r.x];if(1===i){if(2===f||void 0===f)return!0}else if(1===f&&(2===i||void 0===i))return"right";if(2===A[o][a]||2===A[r.y+1][a])return"right";var u=r.x-1;a=u+3;var c=r.y-1;o=c+3;for(var s=[[0,0,0],[0,0,0],[0,0,0]],l=c,v=0;l<o;l++,v--)for(var y=u,h=0;y<a;y++,h++){var b=S*(h-1)-B*(v+1)+1+.01>>0,p=-1*(S*(v+1)+B*(h-1)-1-.01)>>0,x=u+b;if(2===A[c+p][x]){if(x<r.x)return"left";if(x>r.x)return"right"}2!==A[l][y]&&(s[p][b]=A[l][y]?1:0)}return s}function c(r,e){if(0===r.x)return!1;e=e||1;for(var t=r.x-1,n=t+3,a=r.y-1,o=a+4,i=t;i<n;i++)for(var f=a;f<o;f++){var u=A[f];if(u&&1===u[i])for(var c=1;c<=e;){if(void 0===u[i-c]||2===u[i-c])return!1;c++}}n+=2,o+=1;for(var s=t;s<n;s++)for(var l=a;l<o;l++){var v=A[l]&&A[l][s],y=s-e,h=A[l]&&A[l][y];1===v?A[l][y]=v:2!==h&&h&&(A[l][y]=0)}return r.x-=e,!0}function s(r,e){if(r.x!==k-1){e=e||1;for(var t=r.x-1,n=r.x+2,a=r.y-1,o=a+3,i=n;i>=t;i--)for(var f=a;f<o;f++){var u=A[f];if(u&&1===u[i])for(var c=1;c<=e;){if(void 0===u[i+c]||2===u[i+c])return!1;c++}}t--,o+=2;for(var s=n;s>=t;s--)for(var l=a;l<o;l++){var v=A[l]&&A[l][s],y=s+e,h=A[l]&&A[l][y];1===v?A[l][y]=v:2!==h&&h&&(A[l][y]=0)}return r.x+=e,!0}}function l(r){for(var e=r.x-1,t=e+4,n=r.y-1,a=n+4,o=e;o<t;o++)for(var f=n;f<a;f++){var u=A[f];u&&1===u[o]&&(u[o]=2)}var c=m.a[Math.random()*m.a.length>>0];r.x=k/2>>0,r.y=1,e=r.x-1,t=e+4,n=r.y-1,a=n+4;for(var s=n,l=0;s<a;s++,l++)for(var v=e,h=0;v<t;v++,h++){var b=c[l][h];if(0!==A[s][v])return console.log("GAME OVER"),void y();A[s][v]=b}var p=90*(4*Math.random()>>0);0!==A[3][r.x]&&0===p%180||i(r,p)}function v(){for(var r=[],e=0;e<g;e++){for(var t=!0,n=0;n<k;n++)if(2!==A[e][n]){t=!1;break}t&&r.push(e)}r.length>0&&(M=d.a.start(new d.b(j,3,r)),M.running=!0)}function y(){j.clearRect(0,0,k*w,g*w),j.fillStyle="#333333",j.textAlign="center",j.font="bold 30px Arial",j.fillText("GAME OVER",k*w*.5,g*w*.5),p()}function h(r){var e=Date.now();!(e-T>=500&&E!==R)||M&&M.running||(f(_)||(l(_),v()),E!==R&&n(),T=e),d.a.loop(r),q=window.requestAnimationFrame(h)}function b(){A.forEach(function(r,e){A[e]=new Array(k).fill(0)}),R=O}function p(){R=E,cancelAnimationFrame(q)}function x(r){j=r,j.strokeStyle="#00f",E==R&&b(),l(_),n(),h(0)}e.a=a,e.c=p,e.b=x;var d=t(83),m=t(81),w=m.b.bw,g=m.b.stageH,k=m.b.stageW,A=m.b.blocks,_={x:1,y:1},O=1,E=0,R=O,T=Date.now(),j=null,C=null,M=null,q=0,P=-Math.PI/2,S=Math.cos(P),B=Math.sin(P);document.onkeydown=function(r){switch(C=r.keyCode){case 32:i(_),n();break;case 37:c(_),n();break;case 39:s(_),n();break;case 40:f(_),n()}}},81:function(r,e,t){"use strict";t.d(e,"b",function(){return a}),t.d(e,"a",function(){return o});var n=new Array(16).fill(1).map(function(){return new Array(10).fill(0)}),a={bw:20,stageW:10,stageH:16,blocks:n},o=[[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],[[1,1,0,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]]]},83:function(r,e,t){"use strict";function n(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}t.d(e,"b",function(){return s}),t.d(e,"a",function(){return l});var a=t(80),o=t(81),i=function(){function r(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),f=o.b.bw,u=o.b.stageW,c=o.b.blocks,s=function(){function r(e,t,a){n(this,r),this._flashTime=t,this._rowsToRemove=a,this.index=null,this._lastTime=0,this.ctx=e}return i(r,[{key:"update",value:function(r){(0===this._lastTime||r-this._lastTime>300)&&(this.flashOut(this._flashTime,this._rowsToRemove),this._flashTime--,this._lastTime=r)}},{key:"flashOut",value:function(r,e){var t=this,n=this.ctx;n.save(),n.globalAlpha=r%2===0?.2:1,e.forEach(function(r){n.clearRect(0,r*f-1,u*f,f);for(var e=0;e<u;e++)Object(a.a)(r,e)}),n.restore(),r<0&&(l.stop(this.index),e.forEach(function(r){t.rowdown(r)}),this.running=!1)}},{key:"rowdown",value:function(r){for(var e=r;e>=0;e--)for(var t=0;t<u;t++)if(1!==c[e][t]){var n=e-1<0?0:c[e-1][t];c[e][t]=1===n?0:n}}}]),r}(),l={queue:{},start:function(r){var e="animate_"+this.queue.length;return this.queue[e]=r,r.index=e,r.running=!0,r},stop:function(r){delete this.queue[r]},loop:function(r){var e=this.queue;Object.keys(e).forEach(function(t){e[t].update&&e[t].update(r)})}}},84:function(r,e,t){var n=t(85);"string"===typeof n&&(n=[[r.i,n,""]]);var a={hmr:!1};a.transform=void 0;t(77)(n,a);n.locals&&(r.exports=n.locals)},85:function(r,e,t){e=r.exports=t(76)(!0),e.push([r.i,".tetris{border:1px solid #333}","",{version:3,sources:["/Users/weichengchen/work/javascript/demo-list/src/parts/TetrisComp.css"],names:[],mappings:"AAIA,QACE,qBAA0B,CAC3B",file:"TetrisComp.css",sourcesContent:["/* .wrapper {\n  text-align: center;\n} */\n\n.tetris{\n  border: 1px solid #333333;\n}"],sourceRoot:""}])}});
//# sourceMappingURL=0.059e71c5.chunk.js.map